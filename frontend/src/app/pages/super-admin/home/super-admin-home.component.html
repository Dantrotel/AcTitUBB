<!-- Navbar del super administrador -->
<nav class="navbar">
  <div class="navbar-brand">
    <i class="fas fa-graduation-cap"></i>
    <span>AcTitUBB</span>
  </div>
  
  <div class="navbar-actions">
    <!-- Menú de usuario -->
    <div class="action-item user-menu" (click)="toggleUserMenu()">
      <i class="fas fa-user-circle"></i>
      <span>{{ userData()?.nombre || 'Super Administrador' }}</span>
      <i class="fas fa-chevron-down"></i>
      
      <div class="dropdown-menu" [class.show]="showUserMenu()">
        <div class="dropdown-item" (click)="logout()">
          <i class="fas fa-sign-out-alt"></i>
          <span>Cerrar Sesión</span>
        </div>
      </div>
    </div>
  </div>
</nav>

<div class="super-admin-container">

  <!-- Dashboard de estadísticas GLOBALES -->
  @if (loading()) {
    <div class="loading-container">
      <div class="loader"></div>
      <p>Cargando estadísticas del sistema...</p>
    </div>
  }

  @if (!loading()) {
    <!-- ESTRUCTURA ACADÉMICA -->
    <div class="dashboard-section">
      <div class="section-header">
        <h2><i class="fas fa-sitemap"></i> Estructura Académica Global</h2>
        <span class="badge-sistema">Control Total del Sistema</span>
      </div>
      <div class="stats-grid">
        <div class="stat-card primary">
          <div class="stat-icon">
            <i class="fas fa-university"></i>
          </div>
          <div class="stat-content">
            <h3>{{ estadisticasEstructura().totalFacultades }}</h3>
            <p>Facultades</p>
            <span class="stat-badge">Todas</span>
          </div>
        </div>

        <div class="stat-card secondary">
          <div class="stat-icon">
            <i class="fas fa-building"></i>
          </div>
          <div class="stat-content">
            <h3>{{ estadisticasEstructura().totalDepartamentos }}</h3>
            <p>Departamentos</p>
            <span class="stat-badge">Globales</span>
          </div>
        </div>

        <div class="stat-card success">
          <div class="stat-icon">
            <i class="fas fa-graduation-cap"></i>
          </div>
          <div class="stat-content">
            <h3>{{ estadisticasEstructura().totalCarreras }}</h3>
            <p>Carreras Totales</p>
          </div>
        </div>

        <div class="stat-card info">
          <div class="stat-icon">
            <i class="fas fa-user-tie"></i>
          </div>
          <div class="stat-content">
            <h3>{{ estadisticasEstructura().carrerasConJefe }}</h3>
            <p>Con Jefe Asignado</p>
            <span class="stat-detail">{{ estadisticasEstructura().carrerasSinJefe }} sin asignar</span>
          </div>
        </div>
      </div>
    </div>

    <!-- USUARIOS DEL SISTEMA -->
    <div class="dashboard-section">
      <div class="section-header">
        <h2><i class="fas fa-users-cog"></i> Usuarios del Sistema</h2>
        <span class="badge-global">Vista Global</span>
      </div>
      <div class="stats-grid">
        <div class="stat-card-large primary">
          <div class="stat-icon">
            <i class="fas fa-users"></i>
          </div>
          <div class="stat-content">
            <h3>{{ estadisticasUsuarios().totalUsuarios }}</h3>
            <p>Total de Usuarios</p>
            <div class="stat-breakdown">
              <span><i class="fas fa-check-circle"></i> {{ estadisticasUsuarios().usuariosActivos }} activos</span>
              <span><i class="fas fa-clock"></i> {{ estadisticasUsuarios().usuariosPendientes }} pendientes</span>
            </div>
          </div>
        </div>

        <div class="stat-card warning">
          <div class="stat-icon">
            <i class="fas fa-chalkboard-teacher"></i>
          </div>
          <div class="stat-content">
            <h3>{{ estadisticasUsuarios().totalProfesores }}</h3>
            <p>Profesores</p>
            <span class="stat-badge">Todas las facultades</span>
          </div>
        </div>

        <div class="stat-card info">
          <div class="stat-icon">
            <i class="fas fa-user-graduate"></i>
          </div>
          <div class="stat-content">
            <h3>{{ estadisticasUsuarios().totalEstudiantes }}</h3>
            <p>Estudiantes</p>
            <span class="stat-badge">Todas las carreras</span>
          </div>
        </div>

        <div class="stat-card danger">
          <div class="stat-icon">
            <i class="fas fa-user-shield"></i>
          </div>
          <div class="stat-content">
            <h3>{{ estadisticasUsuarios().totalAdmins }}</h3>
            <p>Administradores</p>
            <span class="stat-detail">Jefes de Carrera + Super Admin</span>
          </div>
        </div>
      </div>
    </div>

    <!-- PROPUESTAS Y PROYECTOS -->
    <div class="dashboard-section">
      <div class="section-header">
        <h2><i class="fas fa-project-diagram"></i> Propuestas y Proyectos</h2>
        <span class="badge-sistema">Todas las carreras</span>
      </div>
      <div class="stats-grid">
        <div class="stat-card-large secondary">
          <div class="stat-icon">
            <i class="fas fa-file-alt"></i>
          </div>
          <div class="stat-content">
            <h3>{{ estadisticasProyectos().totalPropuestas }}</h3>
            <p>Total de Propuestas</p>
            <div class="stat-breakdown">
              <span class="text-warning"><i class="fas fa-clock"></i> {{ estadisticasProyectos().propuestasPendientes }} pendientes</span>
              <span class="text-success"><i class="fas fa-check"></i> {{ estadisticasProyectos().propuestasAprobadas }} aprobadas</span>
              <span class="text-danger"><i class="fas fa-times"></i> {{ estadisticasProyectos().propuestasRechazadas }} rechazadas</span>
            </div>
          </div>
        </div>

        <div class="stat-card success">
          <div class="stat-icon">
            <i class="fas fa-tasks"></i>
          </div>
          <div class="stat-content">
            <h3>{{ estadisticasProyectos().totalProyectosActivos }}</h3>
            <p>Proyectos Activos</p>
            <span class="stat-badge">En desarrollo</span>
          </div>
        </div>

        <div class="stat-card info">
          <div class="stat-icon">
            <i class="fas fa-flag-checkered"></i>
          </div>
          <div class="stat-content">
            <h3>{{ estadisticasProyectos().proyectosFinalizados }}</h3>
            <p>Proyectos Finalizados</p>
            <span class="stat-badge">Completados</span>
          </div>
        </div>
      </div>
    </div>

    <!-- CARGA ADMINISTRATIVA -->
    <div class="dashboard-section">
      <div class="section-header">
        <h2><i class="fas fa-chart-bar"></i> Carga Administrativa Global</h2>
        <span class="badge-global">Todos los profesores</span>
      </div>
      <div class="stats-grid">
        <div class="stat-card warning">
          <div class="stat-icon">
            <i class="fas fa-briefcase"></i>
          </div>
          <div class="stat-content">
            <h3>{{ estadisticasCarga().profesoresConCarga }}</h3>
            <p>Profesores con Carga</p>
          </div>
        </div>

        <div class="stat-card secondary">
          <div class="stat-icon">
            <i class="fas fa-user-slash"></i>
          </div>
          <div class="stat-content">
            <h3>{{ estadisticasCarga().profesoresSinCarga }}</h3>
            <p>Profesores sin Carga</p>
          </div>
        </div>

        <div class="stat-card info">
          <div class="stat-icon">
            <i class="fas fa-balance-scale"></i>
          </div>
          <div class="stat-content">
            <h3>{{ estadisticasCarga().promedioCargaProfesor.toFixed(1) }}</h3>
            <p>Promedio de Carga</p>
            <span class="stat-detail">Proyectos por profesor</span>
          </div>
        </div>

        <div class="stat-card danger">
          <div class="stat-icon">
            <i class="fas fa-exclamation-triangle"></i>
          </div>
          <div class="stat-content">
            <h3>{{ estadisticasCarga().maxCargaProfesor }}</h3>
            <p>Carga Máxima</p>
            <span class="stat-detail">Profesor más cargado</span>
          </div>
        </div>
      </div>
    </div>
  }

  <!-- Menú de acciones -->
  <div class="actions-section">
    <h2><i class="fas fa-tools"></i> Gestión del Sistema</h2>
    <div class="actions-grid">
      <a routerLink="/super-admin/gestion-estructura" class="action-card">
        <div class="action-icon">
          <i class="fas fa-sitemap"></i>
        </div>
        <h3>Estructura Académica</h3>
        <p>Gestionar facultades, departamentos, carreras y sus relaciones</p>
      </a>

      <a routerLink="/super-admin/gestionar-jefes" class="action-card">
        <div class="action-icon">
          <i class="fas fa-user-tie"></i>
        </div>
        <h3>Jefes de Carrera</h3>
        <p>Asignar y gestionar jefes de carrera</p>
      </a>


      <a routerLink="/admin/asignaciones" class="action-card">
        <div class="action-icon">
          <i class="fas fa-tasks"></i>
        </div>
        <h3>Asignaciones de Proyectos</h3>
        <p>Asignar profesores a proyectos</p>
      </a>

      <a routerLink="/admin/calendario-unificado" class="action-card">
        <div class="action-icon">
          <i class="fas fa-calendar-alt"></i>
        </div>
        <h3>Calendario Académico</h3>
        <p>Gestionar fechas importantes y plazos</p>
      </a>

      <a routerLink="/admin/usuarios" class="action-card">
        <div class="action-icon">
          <i class="fas fa-user-cog"></i>
        </div>
        <h3>Gestión de Usuarios</h3>
        <p>Administrar cuentas y permisos</p>
      </a>

      <a routerLink="/admin/propuestas" class="action-card">
        <div class="action-icon">
          <i class="fas fa-file-alt"></i>
        </div>
        <h3>Gestión de Propuestas</h3>
        <p>Ver y gestionar todas las propuestas</p>
      </a>
    </div>
  </div>
</div>
