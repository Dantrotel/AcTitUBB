<div class="cambio-obligatorio-container">
  <div class="cambio-obligatorio-card">
    <div class="card-header">
      <div class="icon-wrapper">
        <i class="fas fa-shield-alt"></i>
      </div>
      <h1>Cambio de Contraseña Obligatorio</h1>
      <p class="subtitle">Por seguridad, debes crear una nueva contraseña</p>
    </div>

    <div class="warning-box">
      <i class="fas fa-exclamation-triangle"></i>
      <p><strong>¡Importante!</strong> Has iniciado sesión con una contraseña temporal.</p>
      <p>Debes crear una nueva contraseña segura para continuar.</p>
    </div>

    @if (message()) {
      <div class="alert" [class.alert-success]="messageType() === 'success'" [class.alert-error]="messageType() === 'error'">
        <i [class.fa-check-circle]="messageType() === 'success'" [class.fa-exclamation-circle]="messageType() === 'error'" class="fas"></i>
        <span>{{ message() }}</span>
      </div>
    }

    <div class="password-form">
      <form (ngSubmit)="onSubmit()">
        <div class="form-group">
          <label for="password_nueva">
            <i class="fas fa-lock"></i>
            Nueva Contraseña
          </label>
          <div class="input-wrapper">
            <input
              [type]="showPassword() ? 'text' : 'password'"
              id="password_nueva"
              class="form-input"
              placeholder="Ingresa tu nueva contraseña"
              [(ngModel)]="password_nueva"
              name="password_nueva"
              [disabled]="isLoading()"
              required
              autocomplete="new-password"
            />
            <button
              type="button"
              class="toggle-password"
              (click)="togglePasswordVisibility()"
              [disabled]="isLoading()"
            >
              <i class="fas" [class.fa-eye]="!showPassword()" [class.fa-eye-slash]="showPassword()"></i>
            </button>
          </div>
          <small class="hint">Mínimo 6 caracteres, debe incluir letras y números</small>
        </div>

        <div class="form-group">
          <label for="password_confirmacion">
            <i class="fas fa-lock"></i>
            Confirmar Nueva Contraseña
          </label>
          <div class="input-wrapper">
            <input
              [type]="showConfirmPassword() ? 'text' : 'password'"
              id="password_confirmacion"
              class="form-input"
              placeholder="Confirma tu nueva contraseña"
              [(ngModel)]="password_confirmacion"
              name="password_confirmacion"
              [disabled]="isLoading()"
              required
              autocomplete="new-password"
            />
            <button
              type="button"
              class="toggle-password"
              (click)="toggleConfirmPasswordVisibility()"
              [disabled]="isLoading()"
            >
              <i class="fas" [class.fa-eye]="!showConfirmPassword()" [class.fa-eye-slash]="showConfirmPassword()"></i>
            </button>
          </div>
        </div>

        <div class="requirements-box">
          <h4><i class="fas fa-check-circle"></i> Requisitos de la Contraseña:</h4>
          <ul>
            <li>Mínimo 6 caracteres</li>
            <li>Al menos una letra</li>
            <li>Al menos un número</li>
            <li>Máximo 50 caracteres</li>
          </ul>
        </div>

        <div class="form-actions">
          <button 
            type="submit" 
            class="btn-primary"
            [disabled]="isLoading()"
          >
            <i class="fas" [class.fa-spinner]="isLoading()" [class.fa-spin]="isLoading()" [class.fa-save]="!isLoading()"></i>
            {{ isLoading() ? 'Guardando...' : 'Cambiar Contraseña' }}
          </button>

          <button 
            type="button" 
            class="btn-secondary"
            (click)="logout()"
            [disabled]="isLoading()"
          >
            <i class="fas fa-sign-out-alt"></i>
            Cerrar Sesión
          </button>
        </div>
      </form>
    </div>

    <div class="card-footer">
      <p>
        <i class="fas fa-info-circle"></i>
        Una vez cambiada tu contraseña, deberás iniciar sesión nuevamente
      </p>
    </div>
  </div>
</div>
