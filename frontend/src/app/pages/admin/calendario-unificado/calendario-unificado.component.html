<!-- Contenedor principal -->
<div class="main-container">
  <!-- Header compacto con gradiente -->
  <div class="page-header-compact">
    <div class="header-left">
      <h1>
        <i class="fas fa-calendar-alt"></i>
        Calendario Unificado
      </h1>
      <p class="header-subtitle">Administra fechas importantes, per√≠odos de propuestas y reuniones acad√©micas</p>
    </div>
    <button class="btn-volver" (click)="volver()">
      <i class="fas fa-arrow-left"></i>
      Volver
    </button>
  </div>

  <!-- Mensajes de error/√©xito -->
  <div class="alert alert-error" *ngIf="error">
    <i class="fas fa-exclamation-circle"></i>
    {{ error }}
  </div>

  <div class="alert alert-success" *ngIf="mensaje">
    <i class="fas fa-check-circle"></i>
    {{ mensaje }}
  </div>

  <!-- Tabs de navegaci√≥n -->
  <div class="tabs-navigation">
    <div 
      *ngFor="let tab of tabs" 
      class="tab-item" 
      [class.active]="tabActiva === tab.id"
      (click)="cambiarTab(tab.id)">
      <div class="tab-icon">
        <i [class]="tab.icon"></i>
      </div>
      <div class="tab-label">{{ tab.label }}</div>
    </div>
  </div>

  <!-- Estado de carga -->
  <div *ngIf="loading" class="loading-container">
    <div class="spinner"></div>
    <p>Cargando datos...</p>
  </div>

  <!-- ========== CONTENIDO: CALENDARIO GLOBAL ========== -->
  <div *ngIf="tabActiva === 'calendario' && !loading" class="tab-content">
    <div class="fechas-section">
    <!-- Bot√≥n crear fecha -->
    <div class="section-header">
      <h2><i class="fas fa-calendar-alt"></i> Fechas Globales</h2>
      <button class="btn-primary" (click)="toggleFormularioFecha()">
        <i [class]="mostrarFormularioFecha ? 'fas fa-times' : 'fas fa-plus'"></i>
        {{ mostrarFormularioFecha ? 'Cancelar' : 'Nueva Fecha' }}
      </button>
    </div>

    <!-- Formulario crear fecha -->
    <div class="form-container" *ngIf="mostrarFormularioFecha">
      <form (ngSubmit)="crearFechaGlobal()">
        <div class="form-row">
          <div class="form-group">
            <label for="titulo">T√≠tulo *</label>
            <input 
              type="text" 
              id="titulo" 
              [(ngModel)]="nuevaFecha.titulo"
              name="titulo"
              placeholder="Ej: Inicio de per√≠odo acad√©mico"
              required>
          </div>

          <div class="form-group">
            <label for="fecha">Fecha *</label>
            <input 
              type="date" 
              id="fecha" 
              [(ngModel)]="nuevaFecha.fecha"
              name="fecha"
              required>
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label for="tipo_fecha">Tipo de Fecha *</label>
            <select 
              id="tipo_fecha" 
              [(ngModel)]="nuevaFecha.tipo_fecha"
              name="tipo_fecha"
              required>
              <option value="">Seleccione un tipo</option>
              <optgroup label="üìö Fechas Acad√©micas">
                <option value="academica">Evento Acad√©mico General</option>
                <option value="inicio_semestre">Inicio de Semestre</option>
                <option value="fin_semestre">Fin de Semestre</option>
                <option value="feriado">Feriado / No Laborable</option>
                <option value="receso">Receso Acad√©mico</option>
              </optgroup>
              <optgroup label="üìã Propuestas">
                <option value="entrega_propuesta">‚≠ê Entrega de Propuestas</option>
                <option value="revision_propuesta">Revisi√≥n de Propuestas</option>
              </optgroup>
              <optgroup label="üìÑ Entregas y Avances">
                <option value="entrega">Entrega General</option>
                <option value="entrega_avance">Entrega de Avance</option>
                <option value="entrega_parcial">Entrega Parcial</option>
                <option value="entrega_final">Entrega Final/Memoria</option>
              </optgroup>
              <optgroup label="üìä Evaluaciones">
                <option value="evaluacion">Evaluaci√≥n</option>
                <option value="revision">Revisi√≥n</option>
                <option value="presentacion">Presentaci√≥n</option>
                <option value="defensa">Defensa Final</option>
                <option value="defensa_parcial">Defensa Parcial</option>
              </optgroup>
              <optgroup label="ü§ù Reuniones y Seguimiento">
                <option value="reunion">Reuni√≥n</option>
                <option value="seguimiento">Reuni√≥n de Seguimiento</option>
                <option value="orientacion">Sesi√≥n de Orientaci√≥n</option>
              </optgroup>
              <optgroup label="üìÖ Hitos y Plazos">
                <option value="hito">Hito del Proyecto</option>
                <option value="deadline">Fecha L√≠mite</option>
                <option value="plazo_extension">Plazo de Extensi√≥n</option>
              </optgroup>
              <optgroup label="üéØ Otros">
                <option value="otro">Otro</option>
              </optgroup>
            </select>
          </div>
        </div>

        <!-- Checkbox "Fecha Global" -->
        <div class="form-group checkbox-group">
          <div class="checkbox-label">
            <input 
              type="checkbox" 
              id="es_global" 
              [(ngModel)]="nuevaFecha.es_global"
              name="es_global">
            <label for="es_global" class="checkbox-text">
              <i class="fas fa-globe"></i>
              <strong>‚≠ê Fecha Global</strong>
              <span class="help-text">
                (Requerido para "Entrega de Propuestas" - Controla el per√≠odo de env√≠o y habilita la funcionalidad para estudiantes)
              </span>
            </label>
          </div>
        </div>

        <div class="form-group">
          <label for="descripcion">Descripci√≥n</label>
          <textarea 
            id="descripcion" 
            [(ngModel)]="nuevaFecha.descripcion"
            name="descripcion"
            rows="3"
            placeholder="Descripci√≥n adicional (opcional)"></textarea>
        </div>

        <div class="form-actions">
          <button type="submit" class="btn-primary" [disabled]="guardandoFecha">
            <i class="fas fa-save"></i>
            {{ guardandoFecha ? 'Guardando...' : 'Crear Fecha' }}
          </button>
          <button type="button" class="btn-secondary" (click)="toggleFormularioFecha()">
            <i class="fas fa-times"></i>
            Cancelar
          </button>
        </div>
      </form>
    </div>

    <!-- Estad√≠sticas -->
    <div class="estadisticas-grid" *ngIf="estadisticasFechas">
      <div class="stat-card">
        <div class="stat-icon">
          <i class="fas fa-calendar"></i>
        </div>
        <div class="stat-content">
          <div class="stat-number">{{ estadisticasFechas.total_fechas || 0 }}</div>
          <div class="stat-label">Total Fechas</div>
        </div>
      </div>

      <div class="stat-card success">
        <div class="stat-icon">
          <i class="fas fa-globe"></i>
        </div>
        <div class="stat-content">
          <div class="stat-number">{{ estadisticasFechas.fechas_globales || 0 }}</div>
          <div class="stat-label">Fechas Globales</div>
        </div>
      </div>

      <div class="stat-card warning">
        <div class="stat-icon">
          <i class="fas fa-calendar-check"></i>
        </div>
        <div class="stat-content">
          <div class="stat-number">{{ estadisticasFechas.fechas_futuras || 0 }}</div>
          <div class="stat-label">Pr√≥ximas</div>
        </div>
      </div>
    </div>

    <!-- Listado de fechas -->
    <div class="fechas-grid" *ngIf="fechasGlobales.length > 0">
      <div class="fecha-card" *ngFor="let fecha of fechasGlobales">
        <div class="fecha-header">
          <div class="fecha-icon" [class]="'tipo-' + fecha.tipo_fecha">
            <i class="fas" [class]="getIconoTipoFecha(fecha.tipo_fecha)"></i>
          </div>
          <div class="fecha-info">
            <h3>{{ fecha.titulo }}</h3>
            <p class="fecha-date">
              <i class="fas fa-calendar"></i>
              {{ formatearFecha(fecha.fecha) }}
            </p>
            <span class="fecha-tipo-badge" [class]="'tipo-' + fecha.tipo_fecha">
              {{ fecha.tipo_fecha }}
            </span>
          </div>
        </div>
        
        <p class="fecha-descripcion" *ngIf="fecha.descripcion">
          {{ fecha.descripcion }}
        </p>

        <div class="fecha-actions">
          <button class="btn-danger-sm" (click)="confirmarEliminarFecha(fecha)">
            <i class="fas fa-trash"></i>
            Eliminar
          </button>
        </div>
      </div>
    </div>

    <!-- Estado vac√≠o -->
    <div class="no-fechas" *ngIf="fechasGlobales.length === 0 && !loading">
      <i class="fas fa-calendar-times"></i>
      <p>No hay fechas globales registradas</p>
      <button class="btn-add" (click)="toggleFormularioFecha()">
        <i class="fas fa-plus"></i>
        Crear Primera Fecha
      </button>
    </div>
    </div>
  </div>

  <!-- ========== CONTENIDO: PER√çODO DE PROPUESTAS ========== -->
  <div *ngIf="tabActiva === 'propuestas' && !loading" class="tab-content">
    <div class="section-header">
      <h2><i class="fas fa-calendar-check"></i> Control del Per√≠odo de Propuestas</h2>
    </div>

    <!-- Estado del per√≠odo -->
    <div class="periodo-estado-card" *ngIf="estadoPeriodo">
      <!-- Per√≠odo configurado -->
      <div *ngIf="estadoPeriodo.existe" class="periodo-info">
        <div class="periodo-badge" [class]="getEstadoClass()">
          <i class="fas fa-circle"></i>
          {{ getEstadoLabel() }}
        </div>

        <div class="periodo-details">
          <h3>{{ estadoPeriodo.titulo }}</h3>
          <p class="periodo-descripcion">{{ estadoPeriodo.descripcion }}</p>
          
          <div class="periodo-meta">
            <div class="meta-item">
              <i class="fas fa-calendar"></i>
              <strong>Fecha l√≠mite:</strong> {{ formatearFecha(estadoPeriodo.fecha_limite || '') }}
            </div>
            <div class="meta-item">
              <i class="fas fa-clock"></i>
              <strong>D√≠as restantes:</strong> {{ getDiasRestantesTexto() }}
            </div>
            <div class="meta-item">
              <i class="fas fa-toggle-on"></i>
              <strong>Estado:</strong> {{ estadoPeriodo.habilitada ? 'Habilitado' : 'Deshabilitado' }}
            </div>
          </div>

          <div class="periodo-mensaje" *ngIf="estadoPeriodo.mensaje">
            <i class="fas fa-info-circle"></i>
            {{ estadoPeriodo.mensaje }}
          </div>
        </div>

        <!-- Acciones del per√≠odo -->
        <div class="periodo-actions">
          <button 
            *ngIf="!estadoPeriodo.habilitada"
            class="btn-success" 
            (click)="habilitarPeriodo()">
            <i class="fas fa-check-circle"></i>
            Habilitar Per√≠odo
          </button>

          <button 
            *ngIf="estadoPeriodo.habilitada"
            class="btn-danger" 
            (click)="deshabilitarPeriodo()">
            <i class="fas fa-times-circle"></i>
            Deshabilitar Per√≠odo
          </button>

          <button 
            class="btn-secondary" 
            (click)="deshabilitarVencidos()">
            <i class="fas fa-broom"></i>
            Deshabilitar Vencidos
          </button>

          <button 
            class="btn-secondary" 
            (click)="cambiarTab('calendario')">
            <i class="fas fa-calendar"></i>
            Ver Calendario Global
          </button>
        </div>
      </div>

      <!-- Sin per√≠odo configurado -->
      <div *ngIf="!estadoPeriodo.existe" class="periodo-no-configurado">
        <i class="fas fa-exclamation-triangle"></i>
        <h3>No hay per√≠odo de propuestas configurado</h3>
        <p class="aviso-importante">
          <i class="fas fa-lightbulb"></i>
          <strong>¬øC√≥mo configurar el per√≠odo de propuestas?</strong>
        </p>
        <p class="instrucciones">
          Para habilitar el sistema de propuestas para los estudiantes:
        </p>
        <ol class="pasos-configuracion">
          <li>Ve a la pesta√±a <strong>"Calendario Global"</strong> (primera pesta√±a)</li>
          <li>Click en <strong>"Nueva Fecha"</strong></li>
          <li>Selecciona tipo: <strong>"‚≠ê Entrega de Propuestas"</strong></li>
          <li>‚úÖ <strong>MARCA</strong> el checkbox <strong>"‚≠ê Fecha Global"</strong></li>
          <li>La fecha aparecer√° autom√°ticamente aqu√≠ para habilitarla/deshabilitarla</li>
        </ol>
        <button class="btn-ir-calendario" (click)="cambiarTab('calendario')">
          <i class="fas fa-arrow-left"></i>
          Ir a Calendario Global
        </button>
      </div>
    </div>

    <!-- Lista de TODAS las fechas de Entrega de Propuestas -->
    <div class="propuestas-list">
      <h3>
        <i class="fas fa-list"></i>
        Todas las Fechas de Entrega de Propuestas
      </h3>

      <div *ngIf="todasFechasPropuestas.length === 0" class="no-propuestas">
        <i class="fas fa-calendar-times"></i>
        <p>No hay fechas de "Entrega de Propuestas" publicadas.</p>
        <button (click)="cambiarTab('calendario')">
          <i class="fas fa-plus"></i>
          Crear Primera Fecha
        </button>
      </div>

      <div *ngIf="todasFechasPropuestas.length > 0">
        <div *ngFor="let fecha of todasFechasPropuestas" class="propuesta-card">
          <div class="fecha-header">
            <div class="fecha-icon">
              <i class="fas fa-file-upload"></i>
            </div>
            <div class="fecha-info">
              <h4>{{ fecha.titulo }}</h4>
              <p *ngIf="fecha.descripcion">{{ fecha.descripcion }}</p>
            </div>
            <div class="fecha-estado-badge" [ngClass]="{
              'badge-activo': fecha.habilitada && calcularDiasRestantes(fecha.fecha_limite) > 0,
              'badge-vencido': calcularDiasRestantes(fecha.fecha_limite) < 0,
              'badge-cerrado': !fecha.habilitada
            }">
              <span *ngIf="fecha.habilitada && calcularDiasRestantes(fecha.fecha_limite) > 0">Activo</span>
              <span *ngIf="calcularDiasRestantes(fecha.fecha_limite) < 0">Vencido</span>
              <span *ngIf="!fecha.habilitada">Cerrado</span>
            </div>
          </div>
          
          <div class="fecha-detalles">
            <div class="detalle-item">
              <i class="fas fa-calendar-day"></i>
              <span><strong>Fecha l√≠mite:</strong> {{ formatearFecha(fecha.fecha_limite) }}</span>
            </div>
            <div class="detalle-item">
              <i class="fas fa-hourglass-half"></i>
              <span><strong>D√≠as restantes:</strong> 
                <span [ngClass]="{
                  'text-success': calcularDiasRestantes(fecha.fecha_limite) > 7,
                  'text-warning': calcularDiasRestantes(fecha.fecha_limite) > 0 && calcularDiasRestantes(fecha.fecha_limite) <= 7,
                  'text-danger': calcularDiasRestantes(fecha.fecha_limite) <= 0
                }">
                  {{ calcularDiasRestantes(fecha.fecha_limite) > 0 ? calcularDiasRestantes(fecha.fecha_limite) + ' d√≠as' : 
                     calcularDiasRestantes(fecha.fecha_limite) === 0 ? 'Vence HOY' : 
                     'Vencido hace ' + Math.abs(calcularDiasRestantes(fecha.fecha_limite)) + ' d√≠as' }}
                </span>
              </span>
            </div>
            <div class="detalle-item">
              <i [class]="fecha.habilitada ? 'fas fa-check-circle text-success' : 'fas fa-times-circle text-danger'"></i>
              <span><strong>Estado:</strong> {{ fecha.habilitada ? 'Habilitado' : 'Deshabilitado' }}</span>
            </div>
          </div>
          
          <!-- Botones de Acci√≥n -->
          <div class="fecha-acciones">
            <button class="btn btn-secondary btn-sm" (click)="abrirModalEditarPropuesta(fecha)" title="Editar fecha">
              <i class="fas fa-edit"></i>
              Editar
            </button>
            <button class="btn btn-danger btn-sm" (click)="confirmarEliminarPropuesta(fecha)" title="Eliminar fecha">
              <i class="fas fa-trash-alt"></i>
              Eliminar
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- ========== CONTENIDO: REUNIONES ========== -->
  <div *ngIf="tabActiva === 'reuniones' && !loading" class="tab-content">
    <div class="section-header">
      <h2><i class="fas fa-handshake"></i> Todas las Reuniones</h2>
    </div>

    <!-- Estad√≠sticas de reuniones -->
    <div class="estadisticas-grid" *ngIf="reuniones.length > 0">
      <div class="stat-card">
        <div class="stat-icon">
          <i class="fas fa-handshake"></i>
        </div>
        <div class="stat-content">
          <div class="stat-number">{{ calcularEstadisticasReuniones().total }}</div>
          <div class="stat-label">Total Reuniones</div>
        </div>
      </div>

      <div class="stat-card warning">
        <div class="stat-icon">
          <i class="fas fa-clock"></i>
        </div>
        <div class="stat-content">
          <div class="stat-number">{{ calcularEstadisticasReuniones().programadas }}</div>
          <div class="stat-label">Programadas</div>
        </div>
      </div>

      <div class="stat-card success">
        <div class="stat-icon">
          <i class="fas fa-check-circle"></i>
        </div>
        <div class="stat-content">
          <div class="stat-number">{{ calcularEstadisticasReuniones().confirmadas }}</div>
          <div class="stat-label">Confirmadas</div>
        </div>
      </div>

      <div class="stat-card info">
        <div class="stat-icon">
          <i class="fas fa-calendar-check"></i>
        </div>
        <div class="stat-content">
          <div class="stat-number">{{ calcularEstadisticasReuniones().completadas }}</div>
          <div class="stat-label">Completadas</div>
        </div>
      </div>
    </div>

    <!-- Filtros -->
    <div class="filtros-container">
      <div class="filtro-group">
        <label for="filtroEstado">
          <i class="fas fa-filter"></i>
          Filtrar por estado:
        </label>
        <select 
          id="filtroEstado" 
          [(ngModel)]="filtroEstadoReunion" 
          (change)="aplicarFiltrosReuniones()"
          class="form-select">
          <option *ngFor="let estado of estadosDisponibles" [value]="estado.value">
            {{ estado.label }}
          </option>
        </select>
      </div>

      <div class="filtro-group">
        <label for="busqueda">
          <i class="fas fa-search"></i>
          Buscar:
        </label>
        <input 
          type="text" 
          id="busqueda" 
          [(ngModel)]="busquedaTexto" 
          (input)="aplicarFiltrosReuniones()"
          placeholder="Buscar por nombre o motivo..."
          class="form-input">
      </div>

      <button 
        class="btn-secondary" 
        (click)="limpiarFiltrosReuniones()"
        *ngIf="filtroEstadoReunion || busquedaTexto">
        <i class="fas fa-times"></i>
        Limpiar Filtros
      </button>
    </div>

    <!-- Lista de reuniones -->
    <div class="reuniones-list">
      <h3>{{ getReunionesFiltradasPorEstado().length }} reunion(es) encontrada(s)</h3>
      
      <div 
        class="reunion-item" 
        *ngFor="let reunion of getReunionesFiltradasPorEstado()">
        <div class="reunion-header">
          <div class="reunion-icon">
            <i class="fas fa-handshake"></i>
          </div>
          <div class="reunion-info">
            <h4>{{ reunion.motivo || 'Reuni√≥n de seguimiento' }}</h4>
            <p class="reunion-fecha">
              <i class="fas fa-calendar"></i>
              {{ formatearFecha(reunion.fecha) }} 
              <span class="hora">
                <i class="fas fa-clock"></i>
                {{ formatearHora(reunion.hora_inicio) }}
                <span *ngIf="reunion.hora_fin"> - {{ formatearHora(reunion.hora_fin) }}</span>
              </span>
            </p>
          </div>
        </div>

        <div class="reunion-participantes">
          <span class="participante-badge estudiante">
            <i class="fas fa-user"></i>
            {{ reunion.estudiante_nombre || reunion.estudiante_rut }}
          </span>
          <span class="participante-badge profesor">
            <i class="fas fa-chalkboard-teacher"></i>
            {{ reunion.profesor_nombre || reunion.profesor_rut }}
          </span>
        </div>

        <div class="reunion-estado">
          <span class="estado-badge" [ngClass]="getEstadoReunionClass(reunion.estado)">
            {{ getEstadoReunionLabel(reunion.estado) }}
          </span>
        </div>

        <div class="reunion-descripcion" *ngIf="reunion.descripcion">
          <p><i class="fas fa-info-circle"></i> {{ reunion.descripcion }}</p>
        </div>
      </div>

      <!-- Estado vac√≠o -->
      <div class="no-reuniones" *ngIf="getReunionesFiltradasPorEstado().length === 0">
        <i class="fas fa-calendar-times"></i>
        <p *ngIf="filtroEstadoReunion || busquedaTexto">No se encontraron reuniones con los filtros aplicados</p>
        <p *ngIf="!filtroEstadoReunion && !busquedaTexto">No hay reuniones registradas</p>
      </div>
    </div>
  </div>
</div>

<!-- Modal eliminar fecha -->
<div class="modal-overlay" *ngIf="mostrarModalEliminar" (click)="cancelarEliminar()">
  <div class="modal-container" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h2>
        <i class="fas fa-exclamation-triangle"></i>
        Confirmar Eliminaci√≥n
      </h2>
      <button class="btn-close" (click)="cancelarEliminar()">
        <i class="fas fa-times"></i>
      </button>
    </div>
    <div class="modal-body">
      <p>¬øEst√°s seguro de que deseas eliminar esta fecha?</p>
      <div class="fecha-preview" *ngIf="fechaAEliminar">
        <strong>{{ fechaAEliminar.titulo }}</strong>
        <p>{{ formatearFecha(fechaAEliminar.fecha) }}</p>
      </div>
      <p class="warning-text">Esta acci√≥n no se puede deshacer.</p>
    </div>
    <div class="modal-footer">
      <button class="btn-danger" (click)="eliminarFechaGlobal()" [disabled]="eliminandoFecha">
        <i class="fas fa-trash"></i>
        {{ eliminandoFecha ? 'Eliminando...' : 'S√≠, Eliminar' }}
      </button>
      <button class="btn-secondary" (click)="cancelarEliminar()">
        <i class="fas fa-times"></i>
        Cancelar
      </button>
    </div>
  </div>
</div>

<!-- Modal de Edici√≥n de Propuesta -->
<div class="modal-overlay" *ngIf="mostrarModalEditarPropuesta" (click)="cerrarModalEditarPropuesta()">
  <div class="modal-container" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h3>
        <i class="fas fa-edit"></i>
        Editar Fecha de Entrega de Propuesta
      </h3>
      <button class="btn-close" (click)="cerrarModalEditarPropuesta()">
        <i class="fas fa-times"></i>
      </button>
    </div>
    
    <div class="modal-body">
      <div class="form-group">
        <label for="edit-titulo-propuesta">
          <i class="fas fa-heading"></i>
          T√≠tulo *
        </label>
        <input 
          type="text" 
          id="edit-titulo-propuesta"
          class="form-control"
          [(ngModel)]="fechaPropuestaEditar.titulo"
          placeholder="Ej: Entrega de Propuestas Semestre 1"
          required>
      </div>
      
      <div class="form-group">
        <label for="edit-descripcion-propuesta">
          <i class="fas fa-align-left"></i>
          Descripci√≥n
        </label>
        <textarea 
          id="edit-descripcion-propuesta"
          class="form-control"
          [(ngModel)]="fechaPropuestaEditar.descripcion"
          rows="3"
          placeholder="Descripci√≥n opcional de la fecha"></textarea>
      </div>
      
      <div class="form-group">
        <label for="edit-fecha-propuesta">
          <i class="fas fa-calendar-day"></i>
          Fecha L√≠mite *
        </label>
        <input 
          type="date" 
          id="edit-fecha-propuesta"
          class="form-control"
          [(ngModel)]="fechaPropuestaEditar.fecha_limite"
          required>
      </div>
      
      <div class="form-group">
        <label class="checkbox-label">
          <input 
            type="checkbox" 
            [(ngModel)]="fechaPropuestaEditar.habilitada">
          <span>Fecha habilitada (los estudiantes pueden crear propuestas)</span>
        </label>
      </div>
    </div>
    
    <div class="modal-footer">
      <button class="btn-secondary" (click)="cerrarModalEditarPropuesta()" [disabled]="guardandoPropuesta">
        <i class="fas fa-times"></i>
        Cancelar
      </button>
      <button class="btn-primary" (click)="guardarEdicionPropuesta()" [disabled]="guardandoPropuesta || !fechaPropuestaEditar.titulo || !fechaPropuestaEditar.fecha_limite">
        <i [class]="guardandoPropuesta ? 'fas fa-spinner fa-spin' : 'fas fa-save'"></i>
        {{ guardandoPropuesta ? 'Guardando...' : 'Guardar Cambios' }}
      </button>
    </div>
  </div>
</div>

<!-- Modal de Confirmaci√≥n de Eliminaci√≥n de Propuesta -->
<div class="modal-overlay" *ngIf="mostrarModalEliminarPropuesta" (click)="cancelarEliminarPropuesta()">
  <div class="modal-container modal-small" (click)="$event.stopPropagation()">
    <div class="modal-header modal-header-danger">
      <h3>
        <i class="fas fa-exclamation-triangle"></i>
        Confirmar Eliminaci√≥n
      </h3>
      <button class="btn-close" (click)="cancelarEliminarPropuesta()">
        <i class="fas fa-times"></i>
      </button>
    </div>
    
    <div class="modal-body">
      <p class="text-center">
        ¬øEst√°s seguro de que deseas eliminar esta fecha de entrega de propuestas?
      </p>
      <div class="fecha-info-eliminar">
        <strong>{{ fechaPropuestaEliminar?.titulo }}</strong>
        <p>Fecha: {{ formatearFecha(fechaPropuestaEliminar?.fecha_limite) }}</p>
      </div>
      <p class="warning-text text-center">
        <i class="fas fa-exclamation-circle"></i>
        Esta acci√≥n eliminar√° la fecha de AMBAS tablas (fechas_calendario y fechas_importantes) y no se puede deshacer.
      </p>
    </div>
    
    <div class="modal-footer">
      <button class="btn-secondary" (click)="cancelarEliminarPropuesta()" [disabled]="eliminandoPropuesta">
        <i class="fas fa-times"></i>
        Cancelar
      </button>
      <button class="btn-danger" (click)="eliminarFechaPropuesta()" [disabled]="eliminandoPropuesta">
        <i [class]="eliminandoPropuesta ? 'fas fa-spinner fa-spin' : 'fas fa-trash-alt'"></i>
        {{ eliminandoPropuesta ? 'Eliminando...' : 'Eliminar' }}
      </button>
    </div>
  </div>
</div>
