<!-- Navbar con navegación -->
<nav class="navbar">
  <div class="navbar-brand">
    <i class="fas fa-graduation-cap"></i>
    <span>AcTitUBB</span>
  </div>
  
  <div class="navbar-actions">
    <div class="action-item" (click)="navegar('propuestas/todas')">
      <i class="fas fa-list-alt"></i>
      <span>Todas las Propuestas</span>
    </div>
    
    <div class="action-item" (click)="navegar('propuestas/asignadas')">
      <i class="fas fa-tasks"></i>
      <span>Asignadas</span>
    </div>

    <!-- Menú de Calendario Matching -->
    <div class="action-item calendario-menu" (click)="toggleCalendarioMenu()">
      <i class="fas fa-calendar-alt"></i>
      <span>Calendario</span>
      <i class="fas fa-chevron-down"></i>
      
      <div class="dropdown-menu" [class.show]="showCalendarioMenu">
        <div class="dropdown-item" (click)="navegar('profesor/calendario/dashboard')">
          <i class="fas fa-tachometer-alt"></i>
          <span>Dashboard</span>
        </div>
        <div class="dropdown-item" (click)="navegar('profesor/calendario/disponibilidades')">
          <i class="fas fa-clock"></i>
          <span>Mis Horarios</span>
        </div>
        <div class="dropdown-item" (click)="navegar('profesor/calendario/gestion')">
          <i class="fas fa-calendar-check"></i>
          <span>Mis Reuniones</span>
        </div>
      </div>
    </div>
    
    <div class="action-item user-menu" (click)="toggleUserMenu()" >
      <i class="fas fa-user-circle"></i>
      <span>{{profesor.nombre || 'Profesor'}}</span>
      <i class="fas fa-chevron-down"></i>
      
      <div class="dropdown-menu" [class.show]="showUserMenu">
        <div class="dropdown-item" (click)="navegar('perfil')">
          <i class="fas fa-user"></i>
          <span>Mi Perfil</span>
        </div>
        <div class="dropdown-item" (click)="cerrarSesion()">
          <i class="fas fa-sign-out-alt"></i>
          <span>Cerrar Sesión</span>
        </div>
      </div>
    </div>
  </div>
</nav>

<!-- Contenido principal -->
<div class="main-container">
  <div class="welcome-section">
    <div class="welcome-content">
      <h1><i class="fas fa-chalkboard-teacher"></i> ¡Bienvenido, {{profesor.nombre || 'Profesor'}}!</h1>
      <p class="status-text">
        <i class="fas fa-info-circle"></i>
        Panel de gestión de propuestas de título
      </p>
    </div>
    
    <div class="welcome-illustration">
      <i class="fas fa-rocket"></i>
    </div>
  </div>

  <!-- Dashboard Cards -->
  <div class="dashboard-grid">
    <div class="dashboard-card primary-card" (click)="navegar('propuestas/asignadas')">
      <div class="card-icon">
        <i class="fas fa-tasks"></i>
      </div>
      <div class="card-content">
        <h3>Propuestas Asignadas</h3>
        <p>Revisa las propuestas que estás evaluando actualmente</p>
        <button class="btn-primary">
          <i class="fas fa-eye"></i>
          Ver asignadas
        </button>
      </div>
    </div>
    
    <div class="dashboard-card secondary-card" (click)="navegar('propuestas/todas')">
      <div class="card-icon">
        <i class="fas fa-list-alt"></i>
      </div>
      <div class="card-content">
        <h3>Todas las Propuestas</h3>
        <p>Consulta el listado completo de propuestas del sistema</p>
        <button class="btn-primary">
          <i class="fas fa-search"></i>
          Explorar
        </button>
      </div>
    </div>
    
    <div class="dashboard-card accent-card">
      <div class="card-icon">
        <i class="fas fa-chart-bar"></i>
      </div>
      <div class="card-content">
        <h3>Estadísticas</h3>
        <div class="stats-item">
          <i class="fas fa-file-alt"></i>
          <span>{{ estadisticas.totalPropuestas || 0 }} Propuestas Totales</span>
        </div>
        <div class="stats-item">
          <i class="fas fa-clock"></i>
          <span>{{ estadisticas.pendientes || 0 }} Pendientes de Revisión</span>
        </div>
      </div>
    </div>
    
    <div class="dashboard-card action-card" (click)="abrirCalendario()">
      <div class="card-icon">
        <i class="fas fa-calendar-alt"></i>
      </div>
      <div class="card-content">
        <h3>Calendario de Fechas</h3>
        <div class="date-item" *ngFor="let fecha of proximasFechas">
          <i [class]="fecha.icono"></i>
          <span>{{fecha.titulo}}: {{fecha.fecha | date:'dd MMM'}}</span>
        </div>
        <div class="date-item" *ngIf="proximasFechas.length === 0">
          <i class="fas fa-info-circle"></i>
          <span>No hay fechas programadas</span>
        </div>
        <button class="btn-secondary">
          <i class="fas fa-calendar"></i>
          Ver Calendario
        </button>
      </div>
    </div>
  </div>

  <!-- Sección de Gestión de Proyectos -->
  <div class="projects-section">
    <div class="section-header">
      <h2>
        <i class="fas fa-project-diagram"></i>
        Gestión de Proyectos
      </h2>
      <button class="btn-secondary" (click)="navegarAProyectos()">
        <i class="fas fa-eye"></i>
        Ver Todos
      </button>
    </div>

    <!-- Dashboard de Proyectos -->
    <div class="projects-dashboard">
      <div class="project-stats-grid">
        <div class="stat-card total">
          <div class="stat-icon">
            <i class="fas fa-folder-open"></i>
          </div>
          <div class="stat-content">
            <h3>{{ estadisticasProyectos.totalProyectos }}</h3>
            <p>Proyectos Asignados</p>
          </div>
        </div>

        <div class="stat-card development">
          <div class="stat-icon">
            <i class="fas fa-cogs"></i>
          </div>
          <div class="stat-content">
            <h3>{{ estadisticasProyectos.enDesarrollo }}</h3>
            <p>En Desarrollo</p>
          </div>
        </div>

        <div class="stat-card milestones">
          <div class="stat-icon">
            <i class="fas fa-flag"></i>
          </div>
          <div class="stat-content">
            <h3>{{ estadisticasProyectos.proximosHitos }}</h3>
            <p>Próximos Hitos</p>
          </div>
        </div>

        <div class="stat-card evaluations">
          <div class="stat-icon">
            <i class="fas fa-clipboard-check"></i>
          </div>
          <div class="stat-content">
            <h3>{{ estadisticasProyectos.evaluacionesPendientes }}</h3>
            <p>Evaluaciones Pendientes</p>
          </div>
        </div>
      </div>

      <!-- Proyectos Recientes -->
      <div class="recent-projects">
        <h3>
          <i class="fas fa-clock"></i>
          Proyectos Recientes
        </h3>
        
        <div class="projects-list" *ngIf="proyectosRecientes.length > 0">
          <div class="project-item" *ngFor="let proyecto of proyectosRecientes" (click)="navegarAProyecto(proyecto.id)">
            <div class="project-info">
              <h4>{{ proyecto.titulo }}</h4>
              <p class="project-student">
                <i class="fas fa-user-graduate"></i>
                {{ proyecto.estudiante }}
              </p>
              <div class="project-progress">
                <div class="progress-bar">
                  <div class="progress-fill" [style.width.%]="proyecto.porcentaje_avance"></div>
                </div>
                <span class="progress-text">{{ formatearPorcentaje(proyecto.porcentaje_avance) }}</span>
              </div>
            </div>
            <div class="project-status">
              <span class="status-badge" [class]="getEstadoClase(proyecto.estado)">
                {{ proyecto.estado }}
              </span>
              <small class="last-update">
                <i class="fas fa-clock"></i>
                {{ proyecto.fecha_actualizacion | date:'dd/MM/yyyy' }}
              </small>
            </div>
          </div>
        </div>

        <div class="empty-state" *ngIf="proyectosRecientes.length === 0">
          <i class="fas fa-inbox"></i>
          <p>No tienes proyectos asignados actualmente</p>
        </div>
      </div>

      <!-- Acciones de Proyecto -->
      <div class="project-actions">
        <div class="action-card" (click)="navegarAHitos()">
          <div class="action-icon">
            <i class="fas fa-tasks"></i>
          </div>
          <div class="action-content">
            <h4>Gestionar Hitos</h4>
            <p>Revisar y evaluar hitos de proyectos</p>
          </div>
        </div>

        <div class="action-card" (click)="navegarAEvaluaciones()">
          <div class="action-icon">
            <i class="fas fa-star"></i>
          </div>
          <div class="action-content">
            <h4>Crear Evaluaciones</h4>
            <p>Evaluar avances y entregas</p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Sección de acciones rápidas -->
  <div class="quick-actions-section">
    <h2>Acciones Rápidas</h2>
    <div class="quick-actions-grid">
      <div class="quick-action-item" (click)="navegar('propuestas/todas')">
        <div class="action-icon">
          <i class="fas fa-search"></i>
        </div>
        <div class="action-content">
          <h4>Buscar Propuestas</h4>
          <p>Encuentra propuestas específicas</p>
        </div>
      </div>
      
      <div class="quick-action-item" (click)="navegar('propuestas/asignadas')">
        <div class="action-icon">
          <i class="fas fa-edit"></i>
        </div>
        <div class="action-content">
          <h4>Revisar Pendientes</h4>
          <p>Propuestas que requieren tu atención</p>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Footer -->
<footer class="main-footer">
  <div class="footer-content">
    <p>&copy; {{fechaActual() | date:'yyyy'}} Universidad del Bío-Bío - Sistema de Gestión de Proyectos de Título</p>
  </div>
</footer>

<!-- Modal del Calendario -->
<app-calendar-modal 
  *ngIf="showCalendarModal"
  [propuestas]="[]"
  (close)="cerrarCalendario()">
</app-calendar-modal>
